

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Silicon probe tracking &#8212; BrainGlobe</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/silicon-probe-tracking';</script>
    <link rel="canonical" href="https://brainglobe.info/tutorials/silicon-probe-tracking.html" />
    <link rel="icon" href="../_static/brainglobe.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Whole brain cell detection and registration with the cellfinder command line tool" href="cellfinder-cli/index.html" />
    <link rel="prev" title="Registering a whole-brain dataset to the Allen Mouse Brain atlas with brainreg" href="brainreg.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/brainglobe.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/brainglobe.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">BrainGlobe</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../about.html">
                        About
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../documentation/index.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../more.html">
                        More
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/brainglobe" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/brain_globe" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../about.html">
                        About
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../documentation/index.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../more.html">
                        More
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/brainglobe" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/brain_globe" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Index</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="brainreg.html">Registering a whole-brain dataset to the Allen Mouse Brain atlas with brainreg</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Silicon probe tracking</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cellfinder-cli/index.html">Whole brain cell detection and registration with the cellfinder command line tool</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="cellfinder-cli/setting-up.html">Setting up</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellfinder-cli/running-cellfinder.html">Running cellfinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellfinder-cli/visualising-the-results.html">Visualising the results</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellfinder-cli/exploring-the-numerical-results.html">Exploring the numerical results</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellfinder-cli/visualising-your-data-in-brainrender.html">Visualising your data in brainrender</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Silicon probe tracking</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="silicon-probe-tracking">
<h1>Silicon probe tracking<a class="headerlink" href="#silicon-probe-tracking" title="Permalink to this heading">#</a></h1>
<p>Analysis of silicon probe tracks (e.g., Neuropixels) in brains imaged post-hoc
in a standard coordinate space</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The aim of electrophysiological recordings using silicon probes is to record neuronal activity across brain regions
and animals. It is therefore fundamental to record precisely the localisation of the probe (or multiple probes) in
each brain and be able to compare probes across animals.</p>
<p>Here we describe a tool for the analysis of silicon probe tracks (e.g. <a class="reference external" href="https://www.neuropixels.org/">Neuropixels</a>)
in brains imaged post-hoc in a standard coordinate space. This tool is packaged with brainreg, as part of the
BrainGlobe suite of computational neuroanatomy tools.</p>
</section>
<section id="before-tracing-probe-tracks">
<h2><strong>Before tracing probe tracks</strong><a class="headerlink" href="#before-tracing-probe-tracks" title="Permalink to this heading">#</a></h2>
<p>In order to label the probe penetration track in the brain, the probe is delicately coated with DiI
(Molecular Probes, Cat# V22885) using a pipette tip (<strong>Fig. 1</strong>, left). The probe is then attached to a
micromanipulator, and the probe tip lowered to touch the surface of the brain (e.g. in head-fixed mice).
This position is recorded as position “zero”. The probe is then introduced in the brain at a speed of ~10μm
per second to the desired penetration depth (in our case 1750μm; <strong>Fig. 1</strong>, centre).</p>
<p><img alt="Figure 1." src="../_images/brainreg-segment-fig1.webp" />
<strong>Figure 1.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The final penetration depth has to be recorded precisely (e.g., with the micromanipulator readout) in order to know
how much of the probe shank was used to record neuronal activity. This will allow comparing traced probe tracks and
electrophysiological data.</p>
</div>
<p>When the experiment is done and the probe is retracted, the animal is anaesthetised and perfused with PFA 4% following
standard perfusion protocols. The brain is carefully extracted and left in PFA 4% overnight.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To ensure high quality image registration, it is essential that the brain is properly perfused in order to decrease
the autofluorescence of blood vessels. It is also important that the brain is extracted from the skull carefully in
order to avoid tissue damage.</p>
</div>
<p>The brain is then thoroughly washed with 100mM PBS and imaged (e.g. by
<a class="reference external" href="https://sainsburywellcomecentre.github.io/OpenSerialSection/acquisition/">Serial 2-Photon Tomography</a>; <strong>Fig. 1</strong>,
right). We imaged 2 channels (one where DiI signal is detected and one with background fluorescence only) at a
resolution of x = 5μm, y = 5μm, z = 20μm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to image both the DiI probe signal and the brain’s background fluorescence in two independent channels.
The background signal will be used to register the brain into standard space (since the probe signal might interfere
with the quality of registration).</p>
</div>
</section>
<section id="brain-registration-to-an-atlas">
<h2><strong>Brain registration to an atlas</strong><a class="headerlink" href="#brain-registration-to-an-atlas" title="Permalink to this heading">#</a></h2>
<p>To track the probe in standard space, the brain must first be registered to an atlas using brainreg.</p>
<p>Before registration, brainreg needs to be installed, please follow the instructions
<a class="reference internal" href="../documentation/brainreg/installation.html"><span class="doc std std-doc">here</span></a>. Once installed, we can proceed to register the imaged brain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you activate your conda environment before starting</p>
</div>
<p>You will need:</p>
<ol class="arabic simple">
<li><p>The path where the brain image stack (DiI signal channel) is located</p></li>
<li><p>The path where the brain stack (background fluorescence channel) is located. </p></li>
<li><p>The path where you want the registration result to be saved</p></li>
<li><p>The resolution at which the brain was imaged</p></li>
</ol>
<p><strong>To register your brain to an atlas, please follow the instructions for brainreg
<a class="reference internal" href="../documentation/brainreg/user-guide/brainreg-napari.html"><span class="doc std std-doc">here</span></a></strong>.</p>
<p>A new output directory has been created, which contains the registered brain. We are now ready to manually
trace the probe track.</p>
</section>
<section id="probe-track-tracing">
<h2><strong>Probe track tracing</strong><a class="headerlink" href="#probe-track-tracing" title="Permalink to this heading">#</a></h2>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Make sure your conda environment is still activated!</p>
</div>
<p>To open the graphical user interface, open napari and then load the <code class="docutils literal notranslate"><span class="pre">brainreg-segment</span></code> plugin (see
<a class="reference internal" href="../documentation/brainreg-segment/user-guide/index.html"><span class="doc std std-doc">User guide</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">brainreg-segment</span></code>graphical user interface opens and shows a set of tools.You can then load your brainreg output
directory, and follow the main brainreg-segment instructions <a class="reference internal" href="../documentation/brainreg-segment/user-guide/segmenting-1d-tracks.html"><span class="doc std std-doc">here</span></a> for
segmenting a 1D track. Setting <code class="docutils literal notranslate"><span class="pre">Spline</span> <span class="pre">points</span></code> will determine how many times along the length of the track that
the brain region is sampled at. This can be used to determine the brain region for each recording site on your probe.</p>
<p><strong>Adapted from instructions by</strong> <a class="reference external" href="https://www.sainsburywellcome.org/web/people/mateo-velez-fort"><strong>Mateo Vélez-Fort</strong></a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="brainreg.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Registering a whole-brain dataset to the Allen Mouse Brain atlas with brainreg</p>
      </div>
    </a>
    <a class="right-next"
       href="cellfinder-cli/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Whole brain cell detection and registration with the cellfinder command line tool</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#before-tracing-probe-tracks"><strong>Before tracing probe tracks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-registration-to-an-atlas"><strong>Brain registration to an atlas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probe-track-tracing"><strong>Probe track tracing</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><p class="sphinx-version">
Created using <a href="https://sphinx-doc.org/">Sphinx</a> 6.2.1.
<br/>
</p>
<p class="theme-version">
Built with the
<a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a>
0.13.3.
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="things-in-a-row">
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>